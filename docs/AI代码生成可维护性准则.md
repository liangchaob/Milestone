# AI代码生成可维护性准则

## 目标
- 在使用AI提速的同时，确保代码具备长期可维护、可扩展、可测试。

## 接收标准（必须全部满足）
- 可读性：命名语义化，函数短小，模块职责单一。
- 复杂度：圈复杂度≤10，函数行数≤60，嵌套层级≤3。
- 依赖：禁止引入不必要库，版本固定；优先原生实现。
- 结构：分层清晰，公共API稳定，内部实现可替换。
- 测试：关键逻辑具备最少单元测试或可测示例；无隐藏状态。
- 文档：在PR中附实现说明与可微调参数列表。

## 生成到落地流程
1. 设计骨架：先确定模块边界、数据结构、公共接口，再让AI补内部实现。
2. 输出约束：提示中明确行数、层级、函数数量、禁止库等硬约束。
3. 到达即重构：首次生成后立即进行“简化、命名、解耦”三步轻重构。
4. 可微调点：将常量、样式、选择器集中到配置区或参数，便于后续微调。
5. 测试与示例：为关键路径补最小测试或交互示例，作为回归基线。
6. 记录与版本：保存提示要点、依赖版本及生成原因，确保可复现。

## 评审清单
- 是否小函数+纯函数优先；是否无副作用或副作用集中管理。
- 是否存在魔法数、隐式全局、过度嵌套、复制粘贴堆砌。
- 是否可替换内部实现而不破坏外部接口。
- 是否提供可微调清单与边界条件说明。
- 是否有最小测试覆盖关键路径。

## SVG/前端专项约束
- SVG元素数量受限（≤30），每个关键元素有`id`，属性参数化。
- 组件化输出：拆分为若干小组件/函数，统一配置对象控制样式与位置。
- DOM选择器统一前缀命名，样式通过CSS变量集中管理。

## 遗留系统理解优先
- 先用语义检索/代码地图理解数据流与依赖，再进行生成与重构。

## 拒绝条件（任一命中则退回重做）
- 单文件超长、函数超长、层级过深、不可读命名、隐藏依赖。
- 无说明、无可微调点、测试缺失的关键逻辑。

